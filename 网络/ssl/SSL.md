# HTTPS

## HTTPS 加密在 OSI 的 应用层和传输层

## SSL/TLS 的作用

> 握手协议
> 秘钥规格变更协议
> 应用数据协议
> 警报协议

## 加密算法

> 对称加密 ： 加密和解密都使用同一把秘钥
> 非对称加密 ： 公钥 和 私钥 公钥加密只有对应的私钥可解密，反之，私钥加密也只有对应的公钥才可解密
> 混合加密 ： TLS 采用了这种模式

## 数字证书 CA，Certificate Authority

## CA 的安全验证技术

- 摘要算法

## HTTPS 的握手过程

- 客户端向服务器发起请求, 服务器返回该站点的**公钥**.
- 客户端随机生成**密钥** , 使用**公钥将密钥加密**,将密钥传送给服务器.
- 服务器拿到加密的密钥,使用私钥解密,之后双方传输的数据都使用**密钥加密解密**即可

## HTTPS 是否每次都会在 SSL 层进行密钥传输.

- 不会,每次请求都经历密钥传输 ,比较耗时.
- 服务器会为每个客户端**维护一个 sessionID**, 服务器在拿到客户端的密钥后 将 **密钥保存到 sessionID** 下面
- 客户端的请求会携带 sessionID,服务器根据此 session ID 找到 密钥.

## 如何确保公钥在传输的过程中不被篡改

- 使用数字证书进行验证.
- 数字证书:
  > 网站在使用 https 前,必须向 CA 机构申领数字证书,数字证书包含了持有者的信息,公钥信息等.
  > 操作系统和浏览器本身会预先安装一些它们信任的根证书, 如果其中有 CA 机构的根证书,就可以拿到对应的可信公钥了.

## 数字证书如何防止篡改

- 可以使用数字签名技术.
  > 数字签名过程:
  > CA 机构有非对称加密的私钥和公钥
  > CA 机构对证书明文数据进行 hash
  > 对 hash 后的值使用私钥加密,得到数字签名 s

## 客户端是这样验证服务端的公钥安全，机密的？？

> 客户端在和服务端进行三次握手后 会拿到服务端发送的公钥 1: 使用 CA 机构的公钥解密签名 得到摘要算法计算出的 hashCode1 2:用证书里指定的摘要算法对明文数据做加密，得到 hashCode2。 3: 如果明文数据未被篡改，hashCode2 应该等于 hashCode1。 现在证书是可信的，就可拿到服务器的公钥。
